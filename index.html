<!DOCTYPE html>
<html lang="en">
<head><script type="text/javascript">
/*
disqus.com, 4972842, DIRECT
zetaglobal.net, 100, DIRECT
aps.amazon.com, 31d3a4c9-a8a6-4ae0-a5ae-d3b0de43284c, RESELLER
google.com, pub-6650322601660058, RESELLER, f08c47fec0942fa0
minutemedia.com, 01gcrv9grwe9, RESELLER
criteo.com, B-060574, DIRECT, 9fac4a4a87c2a44f
sharethrough.com, 00PriK0o, RESELLER, d53b998a7bd4ecd2
sharethrough.com, UvcAx8IL, RESELLER, d53b998a7bd4ecd2
amxrtb.com, 105199574, RESELLER
pubmatic.com, 158685, RESELLER, 5d62403b186f2ace
appnexus.com, 2797, RESELLER
smartadserver.com, 4899, RESELLER, 060d053dcf45cbf3
rubiconproject.com, 13380, RESELLER, 0bfd66d529a55807
rubiconproject.com, 18798, RESELLER, 0bfd66d529a55807
madopi.media, 159857, RESELLER
risecodes.com, 6387671b59cc19000143106f, RESELLER
mediafuse.com, 604, RESELLER
appnexus.com, 9538, RESELLER
inmobi.com, 7cd970b6ef494a05b3a4d538650c5e47, RESELLER, 83e75a7ae333ca9d
onetag.com, 5cd7fb62fac7ec9, RESELLER
openx.com, 537133236, RESELLER, 6a698e2ec38604c6
aniview.com, 616704c962b31624e671e171, RESELLER, 78b21b97965ec3f8
video.unrulymedia.com, 919139201, RESELLER
lijit.com, 279534, RESELLER, fafdf38b16bf6b2b #SOVRN
lijit.com, 279534-eb, RESELLER, fafdf38b16bf6b2b #SOVRN
loopme.com, 14872, RESELLER, 6c8d5f95897a5a3b
admanmedia.com, 1069, RESELLER
*/
</script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Testagram</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      background: #000;
      color: #fff;
      font-family: sans-serif;
      width: 100vw;
      overflow-x: hidden;
    }
    header {
      height: 56px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: bold;
      background: #111;
      border-bottom: 1px solid #222;
      color: #fff;
    }
    .story-container {
      display: flex;
      overflow-x: auto;
      gap: 10px;
      padding: 10px;
      background: #111;
      border-bottom: 1px solid #222;
    }
    .story {
      flex: 0 0 auto;
      width: 120px;
      height: 180px;
      background: #222;
      border-radius: 8px;
      text-align: center;
      overflow: hidden;
      box-shadow: 0 0 6px rgba(255,255,255,0.1);
      transition: transform 0.2s ease;
    }
    .story:hover {
      transform: scale(1.05);
      box-shadow: 0 0 10px rgba(255,255,255,0.2);
    }
    .story img {
      width: 100%;
      height: 80px;
      object-fit: cover;
      border-bottom: 1px solid #444;
    }
    .story p {
      padding: 5px;
      font-size: 13px;
      color: #eee;
      line-height: 1.2;
      height: 90px;
      overflow: hidden;
    }
    .ad-box, .thread-box {
      margin: 10px;
      background: #111;
      padding: 12px;
      border-radius: 4px;
      box-shadow: 0 0 8px rgba(255,255,255,0.05);
    }
    iframe {
      width: 100%;
      height: 500px;
      border: none;
      background: #000;
    }
    a {
      color: #4ea1ff;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <header>Testagram</header>
  <div id="stories" class="story-container"></div>

  <div class="ad-box">
    <script type="text/javascript">
      atOptions = {
        'key': '18d0d482298d34bd3713b4a42c4121c6',
        'format': 'iframe',
        'height': 250,
        'width': 300,
        'params': {}
      };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/18d0d482298d34bd3713b4a42c4121c6/invoke.js"></script>
  </div>

  <!-- Added MAGSrv Ad below as requested -->
  <div class="ad-box">
    <script async type="application/javascript" src="https://a.magsrv.com/ad-provider.js"></script> 
    <ins class="eas6a97888e2" data-zoneid="5144454"></ins> 
    <script>(AdProvider = window.AdProvider || []).push({"serve": {}});</script>
  </div>

  <div class="thread-box">
    <iframe src="https://dreez-cell.github.io/Trends/"></iframe>
  </div>

  <div class="thread-box">
    <div id="disqus_thread"></div>
  </div>

  <script>
    const feeds = [
      'https://www.capitalfm.co.ke/news/feed/',
      'https://www.standardmedia.co.ke/rss/headlines.php',
      'https://www.kenyanwallstreet.com/feed/',
      'https://www.tuko.co.ke/rss/',
      'https://www.ghafla.com/ke/feed/',
      'https://www.nation.africa/kenya/rss',
      'https://www.pd.co.ke/feed/',
      'https://www.kenyan-post.com/feeds/posts/default'
    ];

    async function extractImageFromHTML(html) {
      const match = html?.match(/<img[^>]+src=["']([^"']+)["']/);
      return match ? match[1] : 'https://via.placeholder.com/120x80?text=No+Image';
    }

    async function getMicrolinkImage(url, fallbackHTML) {
      try {
        const res = await fetch(`https://api.microlink.io/?url=${encodeURIComponent(url)}`);
        const json = await res.json();
        return json.data.image?.url || await extractImageFromHTML(fallbackHTML);
      } catch {
        return await extractImageFromHTML(fallbackHTML);
      }
    }

    async function loadStories() {
      const container = document.getElementById('stories');
      container.innerHTML = '';
      for (const feed of feeds) {
        try {
          const res = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(feed)}`);
          const data = await res.json();
          for (let item of data.items.slice(0, 5)) {
            const img = await getMicrolinkImage(item.link, item.content || item.description);
            const div = document.createElement('div');
            div.className = 'story';
            div.innerHTML = `<a href="${item.link}" target="_blank" rel="noopener noreferrer"><img src="${img}" alt="story"><p>${item.title}</p></a>`;
            container.appendChild(div);
          }
        } catch (err) {
          console.error('Feed error:', feed, err);
        }
      }
    }

    loadStories();
    setInterval(loadStories, 300000); // every 5 minutes

    var disqus_config = function () {
      this.page.url = window.location.href;
      this.page.identifier = window.location.pathname;
      this.theme = 'dark';
    };
    (function () {
      var d = document, s = d.createElement('script');
      s.src = 'https://celebrity-gossip-3.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>

  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.8.1/firebase-analytics.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyBWb97lOaeRDlyC7kseF5OzZvFBTAtorJQ",
      authDomain: "teatagram-a3a8f.firebaseapp.com",
      projectId: "teatagram-a3a8f",
      storageBucket: "teatagram-a3a8f.firebasestorage.app",
      messagingSenderId: "835709485105",
      appId: "1:835709485105:web:f70765b17d028e6e219510",
      measurementId: "G-XF2WKT1TTE"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
  </script>
</body>
</html>
